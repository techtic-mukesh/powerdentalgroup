{% comment %}
  Renders a header drawer menu for mobile and desktop.

  Usage:
  {% render 'header-drawer' %}
{% endcomment %}

<header-drawer data-breakpoint="{% if section.settings.menu_type_desktop == 'drawer' %}desktop{% else %}tablet{% endif %}">
  <details id="Details-menu-drawer-container" class="menu-drawer-container">
    <summary
      class="header__icon header__icon--menu header__icon--summary link focus-inset"
      aria-label="{{ 'sections.header.menu' | t }}"
    >
      <span>
        <svg class="icon icon-hamburger" viewBox="0 -1 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>hamburger</title> <desc>Created with Sketch Beta.</desc> <defs> </defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"> <g id="Icon-Set" sketch:type="MSLayerGroup" transform="translate(-210.000000, -887.000000)" fill="#000000"> <path d="M229,895 L211,895 C210.448,895 210,895.448 210,896 C210,896.553 210.448,897 211,897 L229,897 C229.552,897 230,896.553 230,896 C230,895.448 229.552,895 229,895 L229,895 Z M229,903 L211,903 C210.448,903 210,903.448 210,904 C210,904.553 210.448,905 211,905 L229,905 C229.552,905 230,904.553 230,904 C230,903.448 229.552,903 229,903 L229,903 Z M211,889 L229,889 C229.552,889 230,888.553 230,888 C230,887.448 229.552,887 229,887 L211,887 C210.448,887 210,887.448 210,888 C210,888.553 210.448,889 211,889 L211,889 Z" id="hamburger" sketch:type="MSShapeGroup"> </path> </g> </g> </g></svg>
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon icon-close"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g id="Menu / Close_LG"> <path id="Vector" d="M21 21L12 12M12 12L3 3M12 12L21.0001 3M12 12L3 21.0001" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g> </g></svg>
      </span>
    </summary>
    <div id="menu-drawer" class="gradient menu-drawer motion-reduce color-{{ section.settings.menu_color_scheme }}">
      <div class="menu-drawer__inner-container">
        <div class="menu-drawer__navigation-container">
            {%- if shop.customer_accounts_enabled -%}
              <a
                href="{%- if customer -%}{{ routes.account_url }}{%- else -%}{{ routes.account_login_url }}{%- endif -%}"
                class="menu-drawer__account link focus-inset h5 medium-hide large-up-hide"
                rel="nofollow"
              >
                {%- if section.settings.enable_customer_avatar -%}
                  <account-icon>
                    {%- if customer and customer.has_avatar? -%}
                      {{ customer | avatar }}
                    {%- else -%}
                      <span class="svg-wrapper">
                        {{- 'icon-account.svg' | inline_asset_content -}}
                      </span>
                    {%- endif -%}
                  </account-icon>
                {%- else -%}
                  <span class="svg-wrapper">
                    {{- 'icon-account.svg' | inline_asset_content -}}
                  </span>
                {%- endif -%}
                {%- liquid
                  if customer
                    echo 'customer.account_fallback' | t
                  else
                    echo 'customer.log_in' | t
                  endif
                -%}
              </a>
            {%- endif -%}
          <nav class="menu-drawer__navigation">
            <ul class="menu-drawer__menu has-submenu list-menu" role="list">
              {%- for link in section.settings.menu.links -%}
                <li>
                  {%- if link.links != blank -%}
                    <details id="Details-menu-drawer-menu-item-{{ forloop.index }}">
                      <summary
                        id="HeaderDrawer-{{ link.handle }}"
                        class="menu-drawer__menu-item list-menu__item link link--text focus-inset{% if link.child_active %} menu-drawer__menu-item--active{% endif %}"
                      >
                        {{ link.title | escape }}
                        <span class="svg-wrapper">
                          {{- 'icon-arrow.svg' | inline_asset_content -}}
                        </span>
                        <span class="svg-wrapper">
                          {{- 'icon-caret.svg' | inline_asset_content -}}
                        </span>
                      </summary>
                      <div
                        id="link-{{ link.handle | escape }}"
                        class="menu-drawer__submenu has-submenu gradient motion-reduce"
                        tabindex="-1"
                      >
                        <div class="menu-drawer__inner-submenu">
                          <button class="menu-drawer__close-button link link--text focus-inset" aria-expanded="true">
                            <span class="svg-wrapper">
                              {{- 'icon-arrow.svg' | inline_asset_content -}}
                            </span>
                            {{ link.title | escape }}
                          </button>
                           {% if forloop.first %}
                            <ul class="menu-drawer__menu list-menu">
                              {% for block in section.blocks %}
                                {% if block.type == 'menu' %}
                                  <li>
                                    <details>
                                      <summary class="menu-drawer__menu-item list-menu__item link link--text focus-inset">
                                        {{ block.settings.menu_title }}
                                        <span class="svg-wrapper">
                                          {{- 'icon-arrow.svg' | inline_asset_content -}}
                                        </span>
                                      </summary>

                                      <div class="menu-drawer__submenu has-submenu gradient motion-reduce" tabindex="-1">
                                        <div class="menu-drawer__inner-submenu">
                                          <button class="menu-drawer__close-button link link--text focus-inset">
                                            <span class="svg-wrapper">
                                              {{- 'icon-arrow.svg' | inline_asset_content -}}
                                            </span>
                                            {{ block.settings.menu_title }}
                                          </button>

                                          <ul class="menu-drawer__menu list-menu">
                                            {%- comment %} Get main collection from menu_link {% endcomment -%}
                                            {%- assign main_handle = block.settings.menu_link | split: '/' | last -%}
                                            {%- assign main_collection = collections[main_handle] -%}

                                            {%- if main_collection != blank -%}
                                              {%- comment %} Level 3 - Get subcategories from metafield {% endcomment -%}
                                              {%- assign subcategories = main_collection.metafields.custom.subcategory.value -%}
                                              
                                              {%- if subcategories != blank -%}
                                                {%- for sub in subcategories -%}
                                                  {%- comment %} Check if Level 3 has subcategories {% endcomment -%}
                                                  {%- assign sub_subcategories = sub.metafields.custom.subcategory.value -%}
                                                  
                                                  {%- if sub_subcategories != blank -%}
                                                    {%- comment %} Level 3 - Has Level 4 subcategories (accordion) {% endcomment -%}
                                                    <li>
                                                      <details>
                                                        <summary class="menu-drawer__menu-item list-menu__item link link--text focus-inset">
                                                          {{ sub.title }}
                                                          <span class="svg-wrapper">
                                                            {{- 'icon-arrow.svg' | inline_asset_content -}}
                                                          </span>
                                                        </summary>

                                                        <div class="menu-drawer__submenu has-submenu gradient motion-reduce" tabindex="-1">
                                                          <div class="menu-drawer__inner-submenu">
                                                            <button class="menu-drawer__close-button link link--text focus-inset">
                                                              <span class="svg-wrapper">
                                                                {{- 'icon-arrow.svg' | inline_asset_content -}}
                                                              </span>
                                                              {{ sub.title }}
                                                            </button>

                                                            <ul class="menu-drawer__menu list-menu">
                                                              {%- for inner_sub in sub_subcategories -%}
                                                                {%- comment %} Check if Level 4 has subcategories {% endcomment -%}
                                                                {%- assign inner_sub_subcategories = inner_sub.metafields.custom.subcategory.value -%}
                                                                
                                                                {%- if inner_sub_subcategories != blank -%}
                                                                  {%- comment %} Level 4 - Has Level 5 subcategories (accordion) {% endcomment -%}
                                                                  <li>
                                                                    <details>
                                                                      <summary class="menu-drawer__menu-item list-menu__item link link--text focus-inset">
                                                                        {{ inner_sub.title }}
                                                                        <span class="svg-wrapper">
                                                                          {{- 'icon-arrow.svg' | inline_asset_content -}}
                                                                        </span>
                                                                      </summary>

                                                                      <div class="menu-drawer__submenu has-submenu gradient motion-reduce" tabindex="-1">
                                                                        <div class="menu-drawer__inner-submenu">
                                                                          <button class="menu-drawer__close-button link link--text focus-inset">
                                                                            <span class="svg-wrapper">
                                                                              {{- 'icon-arrow.svg' | inline_asset_content -}}
                                                                            </span>
                                                                            {{ inner_sub.title }}
                                                                          </button>

                                                                          <ul class="menu-drawer__menu list-menu">
                                                                            {%- for level5 in inner_sub_subcategories -%}
                                                                              {%- comment %} Level 5 - Final level {% endcomment -%}
                                                                              <li>
                                                                                <a href="{{ level5.url }}"
                                                                                   class="menu-drawer__menu-item list-menu__item link link--text">
                                                                                  {{ level5.title }}
                                                                                </a>
                                                                              </li>
                                                                            {%- endfor -%}
                                                                          </ul>
                                                                        </div>
                                                                      </div>
                                                                    </details>
                                                                  </li>
                                                                {%- else -%}
                                                                  {%- comment %} Level 4 - No further subcategories (link) {% endcomment -%}
                                                                  <li>
                                                                    <a href="{{ inner_sub.url }}"
                                                                       class="menu-drawer__menu-item list-menu__item link link--text">
                                                                      {{ inner_sub.title }}
                                                                    </a>
                                                                  </li>
                                                                {%- endif -%}
                                                              {%- endfor -%}
                                                            </ul>
                                                          </div>
                                                        </div>
                                                      </details>
                                                    </li>
                                                  {%- else -%}
                                                    {%- comment %} Level 3 - No subcategories (link) {% endcomment -%}
                                                    <li>
                                                      <a href="{{ sub.url }}"
                                                         class="menu-drawer__menu-item list-menu__item link link--text">
                                                        {{ sub.title }}
                                                      </a>
                                                    </li>
                                                  {%- endif -%}
                                                {%- endfor -%}
                                              {%- endif -%}
                                            {%- endif -%}
                                          </ul>
                                        </div>
                                      </div>
                                    </details>
                                  </li>
                                {% endif %}
                              {% endfor %}
                            </ul>
                          {% else %}
                            <ul class="menu-drawer__menu list-menu" role="list" tabindex="-1">
                              {%- for childlink in link.links -%}
                                <li>
                                  {%- if childlink.links == blank -%}
                                    <a
                                      id="HeaderDrawer-{{ link.handle }}-{{ childlink.handle }}"
                                      href="{{ childlink.url }}"
                                      class="menu-drawer__menu-item link link--text list-menu__item focus-inset{% if childlink.current %} menu-drawer__menu-item--active{% endif %}"
                                      {% if childlink.current %}
                                        aria-current="page"
                                      {% endif %}
                                    >
                                      {{ childlink.title | escape }}
                                    </a>
                                  {%- else -%}
                                    <details id="Details-menu-drawer-{{ link.handle }}-{{ childlink.handle }}">
                                      <summary
                                        id="HeaderDrawer-{{ link.handle }}-{{ childlink.handle }}"
                                        class="menu-drawer__menu-item link link--text list-menu__item focus-inset"
                                      >
                                        {{ childlink.title | escape }}
                                        <span class="svg-wrapper">
                                          {{- 'icon-arrow.svg' | inline_asset_content -}}
                                        </span>
                                        <span class="svg-wrapper">
                                          {{- 'icon-caret.svg' | inline_asset_content -}}
                                        </span>
                                      </summary>
                                      <div
                                        id="childlink-{{ childlink.handle | escape }}"
                                        class="menu-drawer__submenu has-submenu gradient motion-reduce"
                                      >
                                        <button
                                          class="menu-drawer__close-button link link--text focus-inset"
                                          aria-expanded="true"
                                        >
                                          <span class="svg-wrapper">
                                            {{- 'icon-arrow.svg' | inline_asset_content -}}
                                          </span>
                                          {{ childlink.title | escape }}
                                        </button>
                                        <ul
                                          class="menu-drawer__menu list-menu"
                                          role="list"
                                          tabindex="-1"
                                        >
                                          {%- for grandchildlink in childlink.links -%}
                                            <li>
                                              <a
                                                id="HeaderDrawer-{{ link.handle }}-{{ childlink.handle }}-{{ grandchildlink.handle }}"
                                                href="{{ grandchildlink.url }}"
                                                class="menu-drawer__menu-item link link--text list-menu__item focus-inset{% if grandchildlink.current %} menu-drawer__menu-item--active{% endif %}"
                                                {% if grandchildlink.current %}
                                                  aria-current="page"
                                                {% endif %}
                                              >
                                                {{ grandchildlink.title | escape }}
                                              </a>
                                            </li>
                                          {%- endfor -%}
                                        </ul>
                                      </div>
                                    </details>
                                  {%- endif -%}
                                </li>
                              {%- endfor -%}
                            </ul>
                          {% endif %}
                        </div>
                      </div>
                    </details>
                  {%- else -%}
                    <a
                      id="HeaderDrawer-{{ link.handle }}"
                      href="{{ link.url }}"
                      class="menu-drawer__menu-item list-menu__item link link--text focus-inset{% if link.current %} menu-drawer__menu-item--active{% endif %}"
                      {% if link.current %}
                        aria-current="page"
                      {% endif %}
                    >
                      {{ link.title | escape }}
                    </a>
                  {%- endif -%}
                </li>
              {%- endfor -%}
            </ul>
          </nav>
          <div class="menu-drawer__utility-links">
          
            {%- if localization.available_countries or localization.available_languages -%}
              <div class="menu-drawer__localization header-localization">
                {%- if localization.available_countries and localization.available_countries.size > 1 -%}
                  <localization-form>
                    {%- form 'localization', id: 'HeaderCountryMobileForm', class: 'localization-form' -%}
                      <div>
                        <h2 class="visually-hidden" id="HeaderCountryMobileLabel">
                          {{ 'localization.country_label' | t }}
                        </h2>
                        {%- render 'country-localization', localPosition: 'HeaderCountryMobile' -%}
                      </div>
                    {%- endform -%}
                  </localization-form>
                {% endif %}

                {%- if localization.available_languages and localization.available_languages.size > 1 -%}
                  <localization-form>
                    {%- form 'localization', id: 'HeaderLanguageMobileForm', class: 'localization-form' -%}
                      <div>
                        <h2 class="visually-hidden" id="HeaderLanguageMobileLabel">
                          {{ 'localization.language_label' | t }}
                        </h2>
                        {%- render 'language-localization', localPosition: 'HeaderLanguageMobile' -%}
                      </div>
                    {%- endform -%}
                  </localization-form>
                {%- endif -%}
              </div>
            {%- endif -%}
            <ul class="list list-social list-unstyled" role="list">
              {%- if settings.social_twitter_link != blank -%}
                <li class="list-social__item">
                  <a href="{{ settings.social_twitter_link }}" class="list-social__link link">
                    <span class="svg-wrapper">
                      {{- 'icon-twitter.svg' | inline_asset_content -}}
                    </span>
                    <span class="visually-hidden">{{ 'general.social.links.twitter' | t }}</span>
                  </a>
                </li>
              {%- endif -%}
              {%- if settings.social_facebook_link != blank -%}
                <li class="list-social__item">
                  <a href="{{ settings.social_facebook_link }}" class="list-social__link link">
                    <span class="svg-wrapper">
                      {{- 'icon-facebook.svg' | inline_asset_content -}}
                    </span>
                    <span class="visually-hidden">{{ 'general.social.links.facebook' | t }}</span>
                  </a>
                </li>
              {%- endif -%}
               {%- if settings.social_linkedin_link != blank -%}
                <li class="list-social__item">
                  <a target="_blank" href="{{ settings.social_linkedin_link }}" class="link list-social__link">
                    <span class="svg-wrapper">
                      <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 19 19" fill="none">
                        <path d="M14.6327 2.29944C15.0393 2.29944 15.4292 2.46094 15.7167 2.74843C16.0041 3.03591 16.1657 3.42582 16.1657 3.83238V14.563C16.1657 14.9696 16.0041 15.3595 15.7167 15.647C15.4292 15.9344 15.0393 16.096 14.6327 16.096H3.90209C3.49552 16.096 3.10561 15.9344 2.81813 15.647C2.53065 15.3595 2.36914 14.9696 2.36914 14.563V3.83238C2.36914 3.42582 2.53065 3.03591 2.81813 2.74843C3.10561 2.46094 3.49552 2.29944 3.90209 2.29944H14.6327ZM14.2495 14.1798V10.1175C14.2495 9.45476 13.9862 8.81921 13.5176 8.35061C13.049 7.88202 12.4135 7.61876 11.7508 7.61876C11.0993 7.61876 10.3405 8.01733 9.97255 8.61517V7.76439H7.83409V14.1798H9.97255V10.4011C9.97255 9.81087 10.4478 9.32799 11.0379 9.32799C11.3225 9.32799 11.5955 9.44105 11.7967 9.64229C11.998 9.84353 12.111 10.1165 12.111 10.4011V14.1798H14.2495ZM5.34306 6.56103C5.68457 6.56103 6.01209 6.42536 6.25358 6.18388C6.49506 5.94239 6.63073 5.61487 6.63073 5.27335C6.63073 4.56053 6.05588 3.97801 5.34306 3.97801C4.99951 3.97801 4.67004 4.11449 4.42711 4.35741C4.18419 4.60033 4.04772 4.92981 4.04772 5.27335C4.04772 5.98617 4.63024 6.56103 5.34306 6.56103ZM6.40845 14.1798V7.76439H4.28532V14.1798H6.40845Z" fill="#141132"/>
                      </svg>
                    </span>
                    <span class="visually-hidden">{{ 'general.social.links.linkedin' | t }}</span>
                  </a>
                </li>
              {%- endif -%}
              {%- if settings.social_pinterest_link != blank -%}
                <li class="list-social__item">
                  <a href="{{ settings.social_pinterest_link }}" class="list-social__link link">
                    <span class="svg-wrapper">
                      {{- 'icon-pinterest.svg' | inline_asset_content -}}
                    </span>
                    <span class="visually-hidden">{{ 'general.social.links.pinterest' | t }}</span>
                  </a>
                </li>
              {%- endif -%}
              {%- if settings.social_instagram_link != blank -%}
                <li class="list-social__item">
                  <a href="{{ settings.social_instagram_link }}" class="list-social__link link">
                    <span class="svg-wrapper">
                      {{- 'icon-instagram.svg' | inline_asset_content -}}
                    </span>
                    <span class="visually-hidden">{{ 'general.social.links.instagram' | t }}</span>
                  </a>
                </li>
              {%- endif -%}
              {%- if settings.social_tiktok_link != blank -%}
                <li class="list-social__item">
                  <a href="{{ settings.social_tiktok_link }}" class="list-social__link link">
                    <span class="svg-wrapper">
                      {{- 'icon-tiktok.svg' | inline_asset_content -}}
                    </span>
                    <span class="visually-hidden">{{ 'general.social.links.tiktok' | t }}</span>
                  </a>
                </li>
              {%- endif -%}
              {%- if settings.social_tumblr_link != blank -%}
                <li class="list-social__item">
                  <a href="{{ settings.social_tumblr_link }}" class="list-social__link link">
                    <span class="svg-wrapper">
                      {{- 'icon-tumblr.svg' | inline_asset_content -}}
                    </span>
                    <span class="visually-hidden">{{ 'general.social.links.tumblr' | t }}</span>
                  </a>
                </li>
              {%- endif -%}
              {%- if settings.social_snapchat_link != blank -%}
                <li class="list-social__item">
                  <a href="{{ settings.social_snapchat_link }}" class="list-social__link link">
                    <span class="svg-wrapper">
                      {{- 'icon-snapchat.svg' | inline_asset_content -}}
                    </span>
                    <span class="visually-hidden">{{ 'general.social.links.snapchat' | t }}</span>
                  </a>
                </li>
              {%- endif -%}
              {%- if settings.social_youtube_link != blank -%}
                <li class="list-social__item">
                  <a href="{{ settings.social_youtube_link }}" class="list-social__link link">
                    <span class="svg-wrapper">
                      {{- 'icon-youtube.svg' | inline_asset_content -}}
                    </span>
                    <span class="visually-hidden">{{ 'general.social.links.youtube' | t }}</span>
                  </a>
                </li>
              {%- endif -%}
              {%- if settings.social_vimeo_link != blank -%}
                <li class="list-social__item">
                  <a href="{{ settings.social_vimeo_link }}" class="list-social__link link">
                    <span class="svg-wrapper">
                      {{- 'icon-vimeo.svg' | inline_asset_content -}}
                    </span>
                    <span class="visually-hidden">{{ 'general.social.links.vimeo' | t }}</span>
                  </a>
                </li>
              {%- endif -%}
            </ul>
          </div>
        </div>
      </div>
    </div>
  </details>
</header-drawer>