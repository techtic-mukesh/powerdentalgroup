<section class="key-features" style="background-color: {{ section.settings.background_color }};">
  <div class="page-width">
    <div class="key-features__wrap">
      <div class="left-block">
        <h2>{{ section.settings.heading }}</h2>
        <div class="content">
          {{ section.settings.content }}
        </div>
      </div>
      <div class="right-block">
        <span class="bg-media">
          {% if section.settings.video != blank %}
          <video id="myVideo" autoplay muted loop playsinline 
                 {% if section.settings.video_poster != blank %}poster="{{ section.settings.video_poster | img_url: 'master' }}"{% endif %}>
            {% if section.settings.video_mp4 != blank %}
            <source src="{{ section.settings.video_mp4 }}" type="video/mp4" />
            {% endif %}
            {% if section.settings.video_webm != blank %}
            <source src="{{ section.settings.video_webm }}" type="video/webm" />
            {% endif %}
            <!-- Fallback for Shopify native video field -->
            {% if section.settings.video.sources %}
              {% for source in section.settings.video.sources %}
                <source src="{{ source.url }}" type="{{ source.mime_type }}" />
              {% endfor %}
            {% endif %}
          </video>
          {% elsif section.settings.image != blank %}
            <img src="{{ section.settings.image | img_url: 'master' }}" alt="{{ section.settings.heading | escape }}">
          {% endif %}
        </span>
      </div>
    </div>
  </div>
</section>

<style>
section.key-features {
  display: inline-block;
  width: 100%;
  vertical-align: top;
  padding: 40px 0;
}
section.key-features .key-features__wrap {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 42px;
  align-items: center;
}
section.key-features .key-features__wrap img,
section.key-features .key-features__wrap video {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  display: block;
}
section.key-features .key-features__wrap .content ul {
  margin: 0;
  padding: 0;
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 20px;
}
section.key-features .key-features__wrap .content ul li:before {
  content: '';
  display: inline-block;
  width: 24px;
  min-width: 24px;
  height: 24px;
  background-image: url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z' fill='%23000'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-size: 24px;
  margin-top: 3px;
}
section.key-features .key-features__wrap .content ul li {
  display: flex;
  align-items: flex-start;
  gap: 10px;
}
section.key-features .key-features__wrap .right-block span.bg-media {
  display: flex;
  aspect-ratio: 4/3.1;
  border-radius: 20px;
  overflow: hidden;
}

/* Ensure video covers container properly */
section.key-features .key-features__wrap .right-block span.bg-media video {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

@media screen and (max-width: 991px) {
  section.key-features .key-features__wrap {
    grid-template-columns: 1fr;
    gap: 20px;
  }
  section.key-features .key-features__wrap .content ul li {
    font-size: 14px;
  }
  section.key-features .key-features__wrap .content ul li:before {
    width: 20px;
    min-width: 20px;
    height: 20px;
    background-size: contain;
  }
  section.key-features .key-features__wrap .content ul {
    gap: 14px;
  }
}
</style>

{% schema %}
{
  "name": "Key Features",
  "tag": "section",
  "settings": [
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section Title"
    },
    {
      "type": "richtext",
      "id": "content",
      "label": "Content"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Background Image"
    },
    {
      "type": "video",
      "id": "video",
      "label": "Background Video (Shopify Native)"
    },
    {
      "type": "url",
      "id": "video_mp4",
      "label": "Video URL (MP4)",
      "info": "Direct URL to MP4 video file"
    },
    {
      "type": "url",
      "id": "video_webm",
      "label": "Video URL (WebM)",
      "info": "Direct URL to WebM video file for better browser compatibility"
    },
    {
      "type": "image_picker",
      "id": "video_poster",
      "label": "Video Poster Image",
      "info": "Image to display before video loads"
    },
    {
      "type": "checkbox",
      "id": "video_autoplay",
      "label": "Autoplay Video",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "video_loop",
      "label": "Loop Video",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "video_muted",
      "label": "Mute Video",
      "default": true,
      "info": "Required for autoplay in most browsers"
    }
  ],
  "presets": [
    {
      "name": "Key Features",
      "category": "Custom"
    }
  ]
}
{% endschema %}