{{ 'component-card.css' | asset_url | stylesheet_tag }}
{{ 'component-price.css' | asset_url | stylesheet_tag }}
{{ 'section-related-products.css' | asset_url | stylesheet_tag }}

{% if section.settings.image_shape == 'blob' %}
  {{ 'mask-blobs.css' | asset_url | stylesheet_tag }}
{%- endif -%}

{%- unless section.settings.quick_add == 'none' -%}
  {{ 'quick-add.css' | asset_url | stylesheet_tag }}
{%- endunless -%}

{%- if section.settings.quick_add == 'standard' -%}
  <script src="{{ 'quick-add.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'product-form.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

{%- if section.settings.quick_add == 'bulk' -%}
  <script src="{{ 'quick-add-bulk.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'quantity-popover.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'price-per-item.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'quick-order-list.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .recently-viewed-products .card--standard.card--media .card__inner .card__information {
      display: block;
  }

  .recently-viewed-products .card--media .card__inner .card__content {
    opacity: 0;
  }

  .color-scheme-1.gradient.main-recent {
    background: #F7F7FF;
  }

  .color-scheme-1.gradient.main-recent h2.recently-viewed-products__heading {
    color: #010005;
    text-align: center;
    font-family: Montserrat;
    font-size: 44px;
    font-style: normal;
    font-weight: 700;
    line-height: normal;
    text-transform: uppercase;
    margin: 0 0 50px;
  }

  .recently-viewed-products .card--standard .card__inner {
    background: #FFFFFF;
  }

  .recently-viewed-navigation-{{ section.id }} .swiper-horizontal {
    padding-bottom: 2px !important;
  }

  {% if section.settings.enable_swiper %}
  .recently-viewed-swiper-container-{{ section.id }} {
    position: relative;
    overflow: hidden;
    /* Prevent height jumping */
    min-height: 500px;
  }

  .recently-viewed-swiper {
    overflow: visible;
    padding: 0 2px 2px !important;
  }

  .recently-viewed-swiper-{{ section.id }} .swiper-slide {
    height: auto;
    flex-shrink: 0;
    /* Prevent layout shift */
    opacity: 1;
    transition: none;
  }

  .recently-viewed-navigation-{{ section.id }} {
    position: relative;
  }

   .recently-viewed-navigation-{{ section.id }} .swiper-button-prev-{{ section.id }} {
    left: -40px;
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
    cursor: pointer;
   }

   .recently-viewed-navigation-{{ section.id }} .swiper-button-next-{{ section.id }} {
    right: -40px;
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
    cursor: pointer;
   }

    .recently-viewed-navigation-{{ section.id }} .swiper-button-next-{{ section.id }} svg, 
    .recently-viewed-navigation-{{ section.id }} .swiper-button-prev-{{ section.id }} svg {
        width: 40px;
        height: 32px;
    }

  .recently-viewed-navigation-{{ section.id }} .swiper-button-next-{{ section.id }}:hover,
  .recently-viewed-navigation-{{ section.id }} .swiper-button-prev-{{ section.id }}:hover {
    transform: translateY(-50%) scale(1.05);
  }

  .recently-viewed-navigation-{{ section.id }} .swiper-button-next-{{ section.id }}:after,
  .recently-viewed-navigation-{{ section.id }} .swiper-button-prev-{{ section.id }}:after {
    display: none;
  }

  .recently-viewed-navigation-{{ section.id }} .swiper-button-disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }

  .recently-viewed-navigation-{{ section.id }} .swiper-pagination-{{ section.id }} {
    position: relative;
    margin-top: 20px;
    text-align: center;
  }

  .recently-viewed-navigation-{{ section.id }} .swiper-pagination-{{ section.id }} .swiper-pagination-bullet {
    width: 10px;
    height: 10px;
    background: rgba(var(--color-foreground), 0.3);
    border-radius: 50%;
    margin: 0 4px;
    transition: all 0.3s ease;
  }

  .recently-viewed-navigation-{{ section.id }} .swiper-pagination-{{ section.id }} .swiper-pagination-bullet-active {
    background: linear-gradient(90deg, #42c5ef, #0033a0), #fff;
  }

  @media screen and (max-width: 749px) {
    .recently-viewed-navigation-{{ section.id }} .swiper-button-next-{{ section.id }},
    .recently-viewed-navigation-{{ section.id }} .swiper-button-prev-{{ section.id }} {
      display: none;
    }

    .recently-viewed-navigation-{{ section.id }} .swiper-pagination-{{ section.id }} {
      bottom: -20px;
      margin: 0;
    }

    .color-scheme-1.gradient.main-recent h2.recently-viewed-products__heading {
      font-size: 24px;
      margin: 0 0 30px;
    }

    .recently-viewed-swiper-container-{{ section.id }} {
      min-height: 450px;
    }
  }

  @media screen and (min-width: 750px) {
    .recently-viewed-navigation-{{ section.id }} .swiper-pagination-{{ section.id }} {
      display: none;
    }
  }

  .recently-viewed-grid-fallback {
    display: none;
  }

  .no-js .recently-viewed-swiper-container-{{ section.id }} {
    display: none;
  }

  .no-js .recently-viewed-grid-fallback {
    display: block;
  }

  /* Hide section until products are loaded */
  .recently-viewed-products {
    opacity: 1;
  }
  {% endif %}
{%- endstyle -%}

<div class="color-{{ section.settings.color_scheme }} gradient main-recent">
  <div 
    class="recently-viewed-products page-width section-{{ section.id }}-padding isolate{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
    id="RecentlyViewed-{{ section.id }}"
  >
    <h2 class="recently-viewed-products__heading inline-richtext {{ section.settings.heading_size }}">
      {{ section.settings.heading }}
    </h2>
    
    {% if section.settings.enable_swiper %}
      <!-- Swiper Version -->
      <div class="recently-viewed-navigation-{{ section.id }}">
        <div class="recently-viewed-swiper-container-{{ section.id }}">
          <div class="swiper recently-viewed-swiper-{{ section.id }}">
            <div class="swiper-wrapper" id="RecentlyViewedSwiperWrapper-{{ section.id }}">
              <!-- Products injected via JS -->
            </div>
          </div>
        </div>
        
        <!-- Navigation arrows with section-specific classes -->
        <div class="swiper-button-prev-{{ section.id }}">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="43" viewBox="0 0 22 43" fill="none">
            <path d="M21 41.5L0.999998 21.5L21 1.5" stroke="#121212" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="swiper-button-next-{{ section.id }}">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="43" viewBox="0 0 22 43" fill="none">
            <path d="M1 41.5L21 21.5L0.999998 1.5" stroke="#121212" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        
        <!-- Pagination for mobile with section-specific class -->
        <div class="swiper-pagination-{{ section.id }}"></div>
      </div>

      <!-- Fallback Grid (for no-js) -->
      <ul
        class="recently-viewed-grid-fallback grid product-grid grid--{{ section.settings.columns_desktop }}-col-desktop grid--{{ section.settings.columns_mobile }}-col-tablet-down {% if section.settings.quick_add == 'bulk' %} collection-quick-add-bulk{% endif %}"
        role="list"
        id="RecentlyViewedGridFallback-{{ section.id }}"
      >
        <!-- Products injected via JS -->
      </ul>
    {% else %}
      <!-- Original Grid Version -->
      <ul
        class="grid product-grid grid--{{ section.settings.columns_desktop }}-col-desktop grid--{{ section.settings.columns_mobile }}-col-tablet-down {% if section.settings.quick_add == 'bulk' %} collection-quick-add-bulk{% endif %}"
        role="list"
        id="RecentlyViewedGrid-{{ section.id }}"
      >
        <!-- Products injected via JS -->
      </ul>
    {% endif %}
  </div>

  {% if section.settings.image_shape == 'arch' %}
    {{ 'mask-arch.svg' | inline_asset_content }}
  {%- endif -%}
</div>

<script>
(function() {
  const SECTION_ID = '{{ section.id }}';
  const RECENTLY_VIEWED_KEY = 'recentlyViewedProducts';
  const MAX_PRODUCTS = {{ section.settings.products_to_show }};
  const ENABLE_SWIPER = {{ section.settings.enable_swiper | default: false }};

  const sectionElement = document.getElementById(`RecentlyViewed-${SECTION_ID}`);
  const grid = document.getElementById(`RecentlyViewedGrid-${SECTION_ID}`);
  const swiperWrapper = document.getElementById(`RecentlyViewedSwiperWrapper-${SECTION_ID}`);
  const gridFallback = document.getElementById(`RecentlyViewedGridFallback-${SECTION_ID}`);
  
  let swiperInstance = null;
  let isInitialized = false;
  let loadedProductHandles = new Set(); // Track loaded products to prevent duplicates

  // Calculate rewards points based on price
  function calculateRewardPoints(price) {
    // Convert price to number if it's a string
    const numPrice = parseFloat(price);
    
    // Calculate raw points: price / 100 * 5
    const rawPoints = Math.round(numPrice / 100 * 5);
    
    // Get remainder when divided by 10
    const remainder = rawPoints % 10;
    
    let points;
    if (remainder === 5) {
      // If remainder is 5, add 5
      points = rawPoints + 5;
    } else {
      // Otherwise: add 2.5, divide by 5, floor, multiply by 5
      points = Math.floor((rawPoints + 2.5) / 5) * 5;
    }
    
    return points;
  }

  // Get recently viewed from localStorage
  function getRecentlyViewed() {
    try {
      const viewed = JSON.parse(localStorage.getItem(RECENTLY_VIEWED_KEY)) || [];
      {% if product %}
        return viewed.filter(h => h !== '{{ product.handle }}');
      {% else %}
        return viewed;
      {% endif %}
    } catch(e) {
      return [];
    }
  }

  // Save current product
  {% if product %}
    const currentHandle = '{{ product.handle }}';
    let rv = getRecentlyViewed();
    rv = [currentHandle, ...rv.filter(h => h !== currentHandle)].slice(0, MAX_PRODUCTS*2);
    localStorage.setItem(RECENTLY_VIEWED_KEY, JSON.stringify(rv));
  {% endif %}

  // Build Dawn card HTML for grid
  function createCardHTML(product) {
    const li = document.createElement('li');
    li.className = 'grid__item';
    li.dataset.productHandle = product.handle; // Add identifier

    const points = calculateRewardPoints(product.price);

    li.innerHTML = `
      <div class="card-wrapper product-card-wrapper underline-links-hover">
        <div class="card card--standard card--media" style="--ratio-percent: 100%;">
          <div class="card__inner color-scheme-2 gradient ratio" style="--ratio-percent: 100%;">
            <div class="card__media">
              <div class="media media--transparent media--hover-effect">
                <img src="${product.featured_image}" alt="${product.title}" class="motion-reduce" loading="lazy" width="700" height="700">
              </div>
            </div>

            <div class="card__content">
              <div class="card__information">
                <h3 class="card__heading">
                  <a href="${product.url}" class="full-unstyled-link">
                    ${product.title}
                  </a>
                </h3>
              </div>
              <div class="card__badge bottom left"></div>
            </div>
          </div>

          <div class="card__content">
            <div class="card__information">
              <div class="card-information">
                <span class="caption-large light"></span>
                <div class="price">
                  <div class="price__container">
                    <div class="price__regular">
                      <span class="price-item price-item--regular">
                        ${product.price}
                      </span>
                    </div>
                  </div>
                </div>
              </div>

              <h3 class="card__heading h5">
                <a href="${product.url}" class="full-unstyled-link">
                  ${product.title}
                </a>
              </h3>

              <div class="product-sku-stock">
                <span class="product-sku">
                  SKU: <strong>${product.variants[0].sku || ''}</strong>
                </span>
                <span class="product-stock in-stock">
                  <span class="stock-dot"></span> In Stock
                </span>
              </div>

              <!-- Rewards Points Section -->
              <div class="catalog-points" style="margin-bottom:8px; margin-top: 12px;">
                <img src="https://powerdentalgroup.com/cdn/shop/files/reward.svg?v=1762431687&width=50" alt="Reward Points">
                <div class="mp-point-label" style="display:inline-block">
                  <span class="points" style="margin-left: 0">
                    <span class="mp-rw-highlight">${points} points</span>
                  </span>
                </div>
                <div class="clr"></div>
              </div>
            </div>

            <div class="quick-add no-js-hidden">
             <product-form data-section-id="recently-viewed-${product.id}">
  <form method="post" action="/cart/add" id="quick-add-${product.variants[0].id}" accept-charset="UTF-8" class="form" enctype="multipart/form-data" novalidate>
    <input type="hidden" name="form_type" value="product">
    <input type="hidden" name="utf8" value="✓">
    <input type="hidden" name="id" value="${product.variants[0].id}" class="product-variant-id">

    <button id="quick-add-${product.variants[0].id}-submit" type="submit" name="add" class="quick-add__submit button button--full-width button--secondary" aria-haspopup="dialog" aria-live="polite" data-sold-out-message="true">
      <span>Add to cart</span>
      <span class="sold-out-message hidden">Sold out</span>
      <div class="loading__spinner hidden">
        <svg xmlns="http://www.w3.org/2000/svg" class="spinner" viewBox="0 0 66 66">
          <circle stroke-width="6" cx="33" cy="33" r="30" fill="none" class="path"></circle>
        </svg>
      </div>
    </button>

    <input type="hidden" name="product-id" value="${product.id}">
    <input type="hidden" name="section-id" value="recently-viewed-${product.id}">
  </form>

  <button class="whislist-cart">
    <a 
      class="iWishAddColl" 
      href="#" 
      data-variant="${product.variants[0].id}" 
      data-product="${product.id}" 
      data-ptitle="${product.title}" 
      data-manually-bound="true" 
      data-iwclick="true"
    >
      <svg viewBox="0 0 256 256" width="20" class="iwishOutline" xmlns="http://www.w3.org/2000/svg">
        <rect fill="none" height="256" width="256"></rect>
        <path d="M128,216S28,160,28,92A52,52,0,0,1,128,72h0A52,52,0,0,1,228,92C228,160,128,216,128,216Z" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></path>
      </svg>
    </a>
  </button>
</product-form>

            </div>

            <div class="card__badge bottom left"></div>
          </div>
        </div>
      </div>
    `;

    return li;
  }

  // Build card HTML for swiper slide
  function createSwiperSlideHTML(product) {
    const slide = document.createElement('div');
    slide.className = 'swiper-slide';
    slide.dataset.productHandle = product.handle; // Add identifier

    const points = calculateRewardPoints(product.price);

    slide.innerHTML = `
      <div class="card-wrapper product-card-wrapper underline-links-hover">
        <div class="card card--standard card--media" style="--ratio-percent: 100%;">
          <div class="card__inner color-scheme-2 gradient ratio" style="--ratio-percent: 100%;">
            <div class="card__media">
              <div class="media media--transparent media--hover-effect">
                <img src="${product.featured_image}" alt="${product.title}" class="motion-reduce" loading="lazy" width="700" height="700">
              </div>
            </div>

            <div class="card__content">
              <div class="card__information">
                <h3 class="card__heading">
                  <a href="${product.url}" class="full-unstyled-link">
                    ${product.title}
                  </a>
                </h3>
              </div>
              <div class="card__badge bottom left"></div>
            </div>
          </div>

          <div class="card__content">
            <div class="card__information">
              <div class="card-information">
                <span class="caption-large light"></span>
                <div class="price">
                  <div class="price__container">
                    <div class="price__regular">
                      <span class="price-item price-item--regular">
                        ${product.price}
                      </span>
                    </div>
                  </div>
                </div>
              </div>

              <h3 class="card__heading h5">
                <a href="${product.url}" class="full-unstyled-link">
                  ${product.title}
                </a>
              </h3>

              <div class="product-sku-stock">
                <span class="product-sku">
                  SKU: <strong>${product.variants[0].sku || ''}</strong>
                </span>
                <span class="product-stock in-stock">
                  <span class="stock-dot"></span> In Stock
                </span>
              </div>

              <!-- Rewards Points Section -->
              <div class="catalog-points" style="margin-bottom:8px; margin-top: 12px;">
                <img src="https://powerdentalgroup.com/cdn/shop/files/reward.svg?v=1762431687&width=50" alt="Reward Points">
                <div class="mp-point-label" style="display:inline-block">
                  <span class="points" style="margin-left: 0">
                    <span class="mp-rw-highlight">${points} points</span>
                  </span>
                </div>
                <div class="clr"></div>
              </div>
            </div>

            <div class="quick-add no-js-hidden">
              <product-form data-section-id="recently-viewed-${product.id}">
                <form method="post" action="/cart/add" id="quick-add-${product.variants[0].id}" accept-charset="UTF-8" class="form" enctype="multipart/form-data" novalidate>
                  <input type="hidden" name="form_type" value="product">
                  <input type="hidden" name="utf8" value="✓">
                  <input type="hidden" name="id" value="${product.variants[0].id}" class="product-variant-id">

                  <button id="quick-add-${product.variants[0].id}-submit" type="submit" name="add" class="quick-add__submit button button--full-width button--secondary" aria-haspopup="dialog" aria-live="polite" data-sold-out-message="true">
                    <span>Add to cart</span>
                    <span class="sold-out-message hidden">Sold out</span>
                    <div class="loading__spinner hidden">
                      <svg xmlns="http://www.w3.org/2000/svg" class="spinner" viewBox="0 0 66 66">
                        <circle stroke-width="6" cx="33" cy="33" r="30" fill="none" class="path"></circle>
                      </svg>
                    </div>
                  </button>
                  <input type="hidden" name="product-id" value="${product.id}">
                  <input type="hidden" name="section-id" value="recently-viewed-${product.id}">
                </form>
                 <button class="whislist-cart">
                    <a 
                      class="iWishAddColl" 
                      href="#" 
                      data-variant="${product.variants[0].id}" 
                      data-product="${product.id}" 
                      data-ptitle="${product.title}" 
                      data-manually-bound="true" 
                      data-iwclick="true"
                    >
                      <svg viewBox="0 0 256 256" width="20" class="iwishOutline" xmlns="http://www.w3.org/2000/svg">
                        <rect fill="none" height="256" width="256"></rect>
                        <path d="M128,216S28,160,28,92A52,52,0,0,1,128,72h0A52,52,0,0,1,228,92C228,160,128,216,128,216Z" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></path>
                      </svg>
                    </a>
                  </button>
              </product-form>
            </div>

            <div class="card__badge bottom left"></div>
          </div>
        </div>
      </div>
    `;

    return slide;
  }

  // Initialize Swiper - only once
  function initRecentlyViewedSwiper() {
    if (!ENABLE_SWIPER || swiperInstance) return;
    
    const swiperContainer = document.querySelector(`.recently-viewed-swiper-${SECTION_ID}`);
    if (!swiperContainer) return;

    // Check if Swiper library is loaded
    if (typeof Swiper === 'undefined') {
      console.error('Swiper library not loaded');
      return;
    }

    swiperInstance = new Swiper(`.recently-viewed-swiper-${SECTION_ID}`, {
      slidesPerView: 1,
      spaceBetween: 15,
      centeredSlides: false,
      navigation: {
        nextEl: `.swiper-button-next-${SECTION_ID}`,
        prevEl: `.swiper-button-prev-${SECTION_ID}`,
      },
      pagination: {
        el: `.swiper-pagination-${SECTION_ID}`,
        clickable: true,
      },
      breakpoints: {
        640: {
          slidesPerView: 2,
          spaceBetween: 20,
        },
        768: {
          slidesPerView: 3,
          spaceBetween: 25,
        },
        1024: {
          slidesPerView: {{ section.settings.swiper_slides_desktop | default: section.settings.columns_desktop | default: 4 }},
          spaceBetween: 30,
        }
      },
      loop: {{ section.settings.swiper_loop | default: false }},
      watchSlidesProgress: true,
      observer: false,
      observeParents: false,
      autoHeight: false,
      allowTouchMove: true,
      resistance: true,
      resistanceRatio: 0.85,
      on: {
        init: function() {
          console.log('Swiper initialized successfully');
        }
      }
    });
  }

  async function loadProducts() {
    if (isInitialized) return; // Prevent multiple initializations
    isInitialized = true;

    const handles = getRecentlyViewed().slice(0, MAX_PRODUCTS);
    if (!handles.length) {
      if (sectionElement) {
        sectionElement.style.display = 'none';
      }
      return;
    }

    for (const handle of handles) {
      // Skip if already loaded
      if (loadedProductHandles.has(handle)) continue;

      try {
        const res = await fetch(`/products/${handle}.js`);
        if (!res.ok) continue;
        const product = await res.json();

        // Mark as loaded
        loadedProductHandles.add(handle);

        const productData = {
          handle: product.handle,
          title: product.title,
          url: `/products/${product.handle}`,
          featured_image: product.images[0] || '',
          vendor: product.vendor,
          price: `$${(product.price / 100).toFixed(2)}`,
          variants: product.variants,
          id: product.id
        };

        if (ENABLE_SWIPER) {
          // Add to swiper
          if (swiperWrapper && !swiperWrapper.querySelector(`[data-product-handle="${handle}"]`)) {
            const slide = createSwiperSlideHTML(productData);
            swiperWrapper.appendChild(slide);
          }
          // Add to fallback grid
          if (gridFallback && !gridFallback.querySelector(`[data-product-handle="${handle}"]`)) {
            const card = createCardHTML(productData);
            gridFallback.appendChild(card);
          }
        } else {
          // Add to regular grid
          if (grid && !grid.querySelector(`[data-product-handle="${handle}"]`)) {
            const card = createCardHTML(productData);
            grid.appendChild(card);
          }
        }
      } catch(err) {
        console.warn(`Failed to load product ${handle}`, err);
      }
    }

    // Initialize swiper after ALL products are loaded
    if (ENABLE_SWIPER) {
      setTimeout(initRecentlyViewedSwiper, 100);
    } else {
      // Show section for grid layout
      if (sectionElement) {
        sectionElement.setAttribute('data-loading', 'false');
      }
    }
  }

  // Single initialization on DOMContentLoaded
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadProducts);
  } else {
    loadProducts();
  }

  // Handle Shopify section reload
  document.addEventListener('shopify:section:load', function(event) {
    if (event.detail && event.detail.sectionId === SECTION_ID) {
      // Reset state
      isInitialized = false;
      loadedProductHandles.clear();
      if (swiperInstance) {
        swiperInstance.destroy(true, true);
        swiperInstance = null;
      }
      // Reload products
      setTimeout(loadProducts, 100);
    }
  });
})();
</script>

{% schema %}
{
  "name": "Recently viewed products",
  "tag": "section",
  "class": "section",
  "settings": [
    { "type": "inline_richtext", "id": "heading", "default": "Recently viewed products", "label": "Heading" },
    { "type": "select", "id": "heading_size", "default": "h2", "label": "Heading size", "options":[
      { "value":"h1","label":"H1" },
      { "value":"h2","label":"H2" },
      { "value":"h0","label":"H0" },
      { "value":"hxl","label":"Extra large" },
      { "value":"hxxl","label":"Extra extra large" }
    ]},
    { "type": "range","id":"products_to_show","min":2,"max":10,"step":1,"default":4,"label":"Products to show"},
    { "type": "range","id":"columns_desktop","min":1,"max":6,"step":1,"default":4,"label":"Columns (desktop)"},
    { "type": "select","id":"columns_mobile","default":"2","label":"Columns (mobile)","options":[
      { "value":"1","label":"1 column"},
      { "value":"2","label":"2 columns"}
    ]},
    { "type":"color_scheme","id":"color_scheme","label":"Color scheme","default":"scheme-1"},
    {
      "type": "header",
      "content": "Swiper Settings"
    },
    {
      "type": "checkbox",
      "id": "enable_swiper",
      "default": false,
      "label": "Enable Swiper Carousel"
    },
    {
      "type": "range",
      "id": "swiper_slides_desktop",
      "min": 1,
      "max": 6,
      "step": 1,
      "default": 4,
      "label": "Slides per view (Desktop)",
      "info": "Number of slides visible at once on desktop"
    },
    {
      "type": "checkbox",
      "id": "swiper_loop",
      "default": false,
      "label": "Enable infinite loop"
    },
    { "type":"select","id":"image_ratio","options":[
      {"value":"adapt","label":"Adapt to image"},
      {"value":"portrait","label":"Portrait"},
      {"value":"square","label":"Square"}
    ],"default":"adapt","label":"Image ratio"},
    { "type":"select","id":"image_shape","options":[
      {"value":"default","label":"Default"},
      {"value":"arch","label":"Arch"},
      {"value":"blob","label":"Blob"},
      {"value":"chevronleft","label":"Chevron left"},
      {"value":"chevronright","label":"Chevron right"},
      {"value":"diamond","label":"Diamond"},
      {"value":"parallelogram","label":"Parallelogram"},
      {"value":"round","label":"Round"}
    ],"default":"default","label":"Image shape"},
    { "type":"checkbox","id":"show_secondary_image","default":false,"label":"Show secondary image"},
    { "type":"checkbox","id":"show_vendor","default":false,"label":"Show vendor"},
    { "type":"checkbox","id":"show_rating","default":false,"label":"Show product rating"},
    { "type":"select","id":"quick_add","default":"none","label":"Quick add","options":[
      {"value":"none","label":"None"},
      {"value":"standard","label":"Standard"},
      {"value":"bulk","label":"Bulk"}
    ]},
    { "type":"text","id":"error_message","label":"Error message"},
    { "type":"range","id":"padding_top","min":0,"max":100,"step":4,"unit":"px","label":"Padding top","default":36},
    { "type":"range","id":"padding_bottom","min":0,"max":100,"step":4,"unit":"px","label":"Padding bottom","default":36}
  ],
  "presets":[{"name":"Recently viewed products"}]
} 
{% endschema %}