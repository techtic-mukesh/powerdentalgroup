<div class="swiper banner-swiper">
  <div class="swiper-wrapper">
    {% for block in section.blocks %}
      <div class="swiper-slide slideshow__slide">
        <div class="slideshow__media">
          {% if block.settings.image != blank %}
          <img src="{{ block.settings.image | img_url: '' }}" alt="{{ block.settings.heading | escape }}" {% if forloop.index == 1 %}style="transform: scaleX(-1);"{% endif %} class="{% if forloop.index == 2 %}bottom-center{% endif %}">
          {% endif %}

          {% if block.settings.mobile-image != blank %}
            <img class="banner-mb {% if forloop.index == 4 %} banner-mb-last {% endif %}" style="display: none;" src="{{ block.settings.mobile-image | img_url: '' }}" alt="{{ block.settings.heading | escape }}">
          {% endif %}
        </div>
        <div class="slideshow__text-wrapper">
          <div class="page-width-banner">
            <div class="slideshow__text {% if block.settings.position == true %}position-left{% endif %}  {% if forloop.index == 4 %} banner-mb-content {% endif %}">
              {% if block.settings.auth_image != blank %}
                <div class="top-logo">
                  <img src="{{ block.settings.auth_image | img_url: '' }}" alt="">
                </div>
              {% endif %}
              {% if block.settings.heading != blank %}
                <h2 class="slideshow__heading" style="color: {{ block.settings.heading_color | default: '#fff' }};">{{ block.settings.heading }}</h2>
              {% endif %}
              {% if block.settings.subheading != blank %}
                <div class="slideshow__subheading" style="color: {{ block.settings.description_color | default: '#fff' }};">{{ block.settings.subheading }}</div>
              {% endif %}
              {% if block.settings.button_label != blank %}
                <div class="slideshow_button">
                  <a href="{{ block.settings.button_link }}" class="button button--primary">
                    <span>{{ block.settings.button_label }}</span>
                    {% render 'button-arrow-primary' %}
                  </a>
                </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <!-- Swiper navigation + pagination -->
  <div class="swiper-pagination"></div>
</div>



<script>
    document.addEventListener("DOMContentLoaded", () => {
        const swiperEl = document.querySelector(".banner-swiper");
  
        if (swiperEl) {
            const observer = new IntersectionObserver((entries, obs) => {
                if (entries[0].isIntersecting) {
                    // Get settings from section
                    const autoplay = {{ section.settings.autoplay | json }};
                    const autoplayDelay = {{ section.settings.autoplay_delay | json }};
                    const transitionSpeed = {{ section.settings.transition_speed | json }};
                    
                    const swiperConfig = {
                        loop: true,
                        speed: transitionSpeed,
                      effect: 'creative',
                        creativeEffect: {
                          prev: {
                            translate: ['-120%', 0, -500],
                            rotate: [0, 0, -15],
                            scale: 0.8,
                            opacity: 0.6,
                            shadow: true
                          },
                          next: {
                            translate: ['120%', 0, -500],
                            rotate: [0, 0, 15],
                            scale: 0.8,
                            opacity: 0.6,
                            shadow: true
                          }
                        },
                        pagination: { 
                            el: ".swiper-pagination", 
                            clickable: true 
                        },
                        navigation: false,
                    };
                    
                    // Add autoplay if enabled
                    if (autoplay) {
                        swiperConfig.autoplay = {
                            delay: autoplayDelay,
                            disableOnInteraction: false
                        };
                    }
                    
                    new Swiper(".banner-swiper", swiperConfig);
                    obs.disconnect(); // init only once
                }
            });
            observer.observe(swiperEl);
        }
    });
</script>

<style>
  /* FIXED CSS - Replace your existing styles with these */
  
  .slideshow__slide {
    /* Remove grid and add proper positioning */
    position: relative;
    display: block !important; /* Override Swiper's flex display */
    width: 100%;
    height: auto;
    /* Remove all grid-template properties */
  }

  .slideshow__slide .slideshow__media {
    /* Keep as background layer */
    position: relative;
    width: 100%;
    z-index: 1;
    display: flex;
  }

  .page-width-banner {
    max-width: 1320px;
    margin: 0 auto;
    padding-left: 5rem;
    padding-right: 5rem;
    width: 100%; /* Add width 100% */
  }

  .slideshow__slide .slideshow__text-wrapper {
    /* MAIN FIX - Proper absolute positioning */
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 2;
    display: flex;
    align-items: center;
    justify-content: center;
    /* Remove the transform and top: 50% */
  }

  .slideshow__text {
    max-width: 561px;
    margin-left: auto;
    color: #fff;
  }

  .slideshow__text h2.slideshow__heading {
    margin: 0 0 10px;
    position: relative;
    font-size: 43px;
    line-height: 60px;
    text-transform: uppercase;
    font-family: Montserrat;
    text-align: left;
  }

  .slideshow__subheading p {
    margin: 0;
    font-size: 18px;
    font-style: normal;
    line-height: 26px;
  }

  .slideshow__text .top-logo {
    max-width: 150px;
    display: flex;
    margin: 0 0 8px;
}

.slideshow__text .top-logo img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: left;
}

  .slideshow__slide .slideshow__media img {
    width: 100%;
    height: 100%;
    /* aspect-ratio: 16 / 6; */
    max-height: 768px;
    object-fit: cover;
    display: block; /* Add display block */
  }

  .banner-swiper .swiper-wrapper > .slideshow__slide .slideshow__media img.bottom-center {
    object-position: bottom center;
   }

  .slideshow_button {
    margin: 30px 0 0;
  }

  .swiper-3d {
    background: #141132;
  }

  .slideshow_button a.button.button--primary {
    border-radius: 10px;
    background: linear-gradient(0deg, #FFF 0%, #FFF 100%), linear-gradient(90deg, #42C5EF 0%, #0033A0 100%);
    color: #0033A0;
    font-family: Montserrat;
    font-size: 14px;
    font-style: normal;
    font-weight: 600;
    text-transform: uppercase;
    line-height: normal;
    padding: 16.5px 20px;
    text-decoration: none; /* Add this */
    transition: all 0.3s ease; /* Add smooth transition */
    min-height: auto;
  }

  .slideshow_button a.button.button--primary:after {
    display: none;
  }

  /* Dots style */
  .banner-swiper .swiper-pagination-bullet {
    width: 10px;
    height: 10px;
    background: transparent;
    border-radius: 50%;
    opacity: 1;
    margin: 0 4px !important;
    transition: all 0.3s ease;
    cursor: pointer;
    border: none;
    box-sizing: border-box;
    background-image: url("data:image/svg+xml, %3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 10 10' fill='none'%3E%3Crect x='0.5' y='0.5' width='9' height='9' rx='4.5' stroke='white'/%3E%3C/svg%3E");
    background-size: 10px;
    background-repeat: no-repeat;
    background-position: center;
    padding: 6px;
  }

  .banner-swiper .swiper-pagination-bullet-active {
    background-image: url("data:image/svg+xml, %3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 10 10' fill='none'%3E%3Crect x='0.5' y='0.5' width='9' height='9' rx='4.5' stroke='white'/%3E%3Crect x='2' y='2' width='6' height='6' rx='3' fill='white'/%3E%3C/svg%3E");
  }

  .banner-swiper .swiper-pagination-bullet:hover:not(.swiper-pagination-bullet-active) {
    opacity: 0.8;
  }

  .banner-swiper .swiper-pagination {
    bottom: 17px !important;
    display: flex;
    justify-content: center;
    z-index: 3; /* Add z-index to ensure pagination is on top */
  }

  .slideshow_button a.button.button--primary {
    display: inline-flex;
    align-items: center;
    gap: 10px;
  }

  .slideshow_button a.button.button--primary:hover {
    background: linear-gradient(90deg, #42C5EF 0%, #0033A0 100%), linear-gradient(0deg, #FFF 0%, #FFF 100%), linear-gradient(90deg, #42C5EF 0%, #0033A0 100%);
    color: #fff;
  }

  .slideshow_button a.button.button--primary:hover svg path {
    stroke: #fff;
  }

  .slideshow__text.position-left {
    margin: 0;
  }

    @media only screen and (max-width: 1300px) {  
      .slideshow__text h2.slideshow__heading {
    font-size: 32px;
    line-height: 1.4;
}

.slideshow__text {
      max-width: 520px;
}

.page-width-banner {
    padding-left: 2rem;
    padding-right: 2rem;
}

.slideshow__subheading p {
    font-size: 16px;
    line-height: 1.4;
}
    }

  @media only screen and (max-width: 1140px) { 
    .slideshow__slide .slideshow__media img {
    aspect-ratio: 16 / 9;
}

  .slideshow__text h2.slideshow__heading {
    font-size: 24px;
}

.slideshow__text {
    max-width: 400px;
}
  }


  @media only screen and (max-width: 991px) {
    .page-width-banner {
      padding: 0 15px;
    }

    .slideshow__text h2.slideshow__heading {
      font-size: 32px;
      line-height: 40px;
    }

  
    

    .slideshow__subheading p {
      font-size: 16px;
    }

    .slideshow_button {
      margin: 20px 0 0;
    }
  }

    @media only screen and (max-width: 940px) {
      .slideshow__slide .slideshow__media img {
      display: none;
    }

    .slideshow__text .top-logo {
    margin: 0 auto 8px;
}

    .slideshow__slide .slideshow__media img.banner-mb {
      display: block !important;
              /* aspect-ratio: 4 / 2.5; */
              aspect-ratio: 4/4;
        object-position: bottom;
    }

    .slideshow__text {
    max-width: 100%;
    text-align: center;
}

.slideshow__text h2.slideshow__heading {
  text-align: center;
}
    }
 
  @media only screen and (max-width: 767px) {
    
  .slideshow__slide .slideshow__media img.banner-mb {
      aspect-ratio: 4 / 4.9;
      
    }
    .slideshow_button a.button.button--primary {
      padding: 15px;
      font-size: 14px;
    }

    .slideshow__subheading p {
      font-size: 14px;
      line-height: 1.4;
    }

    .slideshow__text {
      text-align: center;
      margin: 0 auto;
    }

    .slideshow__text.position-left {
      margin: 0 auto;
    }

    .slideshow__text h2.slideshow__heading {
      font-size: 24px;
      line-height: 1.4;
      text-align: center;
    }

    .slideshow_button a.button.button--primary svg {
      width: 26px;
      min-width: 26px;
    }
  }

   @media only screen and (max-width: 540px) {
    .slideshow__slide .slideshow__media img.banner-mb {
                  aspect-ratio: 4 / 5.9;
    }

    .slideshow__slide .slideshow__media img.banner-mb.banner-mb-last {
    object-position: 33%;
}

.slideshow__text.position-left.banner-mb-content {
        padding-bottom: 100px;
}
    }
</style>



{% schema %}
  {
    "name": "Slideshow Swiper",
    "settings": [
      {
        "type": "checkbox",
        "id": "autoplay",
        "label": "Enable Autoplay",
        "default": true
      },
      {
        "type": "range",
        "id": "autoplay_delay",
        "min": 2000,
        "max": 9500,
        "step": 500,
        "unit": "ms",
        "label": "Autoplay Delay",
        "default": 5000
      },
      {
        "type": "range",
        "id": "transition_speed",
        "min": 300,
        "max": 2000,
        "step": 100,
        "unit": "ms",
        "label": "Transition Speed",
        "default": 800
      }
    ],
    "blocks": [
      {
        "type": "slide",
        "name": "Slide",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Desktop Banner image"
          },
          {
            "type": "image_picker",
            "id": "mobile-image",
            "label": "Mobile Banner image"
          },
          {
            "type": "text",
            "id": "heading",
            "label": "Heading"
          },
          {
            "type": "color",
            "id": "heading_color",
            "label": "Heading Color",
            "default": "#ffffff"
          },
          {
            "type": "richtext",
            "id": "subheading",
            "label": "Subheading"
          },
          {
            "type": "color",
            "id": "description_color",
            "label": "Description Color",
            "default": "#ffffff"
          },
           {
            "type": "image_picker",
            "id": "auth_image",
            "label": "Logo Image"
          },
          {
            "type": "text",
            "id": "button_label",
            "label": "Button label"
          },
          {
            "type": "url",
            "id": "button_link",
            "label": "Button link"
          },
          {
            "type": "checkbox",
            "id": "position",
            "label": "Content Position Left",
            "default": false
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Slideshow Swiper",
        "blocks": [
          {
            "type": "slide"
          },
          {
            "type": "slide"
          }
        ]
      }
    ]
  }
{% endschema %}